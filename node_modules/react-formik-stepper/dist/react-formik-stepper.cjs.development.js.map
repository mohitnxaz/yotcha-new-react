{"version":3,"file":"react-formik-stepper.cjs.development.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Formik } from 'formik';\nimport * as yup from 'yup';\nimport 'animate.css';\nimport { FormikStepperProps } from './types/FormikStepperProps';\nimport { FormikTransitions } from './types/FormikTransitions';\n\nconst FormikStepper = (props: FormikStepperProps) => {\n  const { children, animate = true, ...rest } = props;\n\n  const getSteps = () => React.Children.toArray(children);\n\n  const totalSteps = getSteps().length;\n  const [step, setStep] = useState(0);\n  const [classes, setClasses] = useState<{\n    [key: string]: string;\n  }>({});\n\n  let child = Array.isArray(children) ? children[step] : children;\n  const childIndex = Array.isArray(children) ? step : 0;\n  const schema = yup.object().shape(child.props?.validation || {});\n\n  const transitions = {\n    enterRight: `animate__animated animate__fadeInRight`,\n    enterLeft: `animate__animated animate__fadeInLeft`,\n    exitRight: `animate__animated animate__fadeOutRight`,\n    exitLeft: `animate__animated animate__fadeOutLeft`,\n  };\n\n  const setActiveStep = (next: number) => {\n    if (next === step) return;\n\n    if (isInvalidStep(next)) {\n      if (process.env.NODE_ENV !== 'production') {\n        console.error(`${next + 1} is an invalid step`);\n      }\n      return;\n    }\n\n    const classes: FormikTransitions = {};\n\n    if (step < next) {\n      //slide left\n      classes[step] = transitions.exitLeft;\n      classes[next] = transitions.enterRight;\n    } else {\n      //slide right\n      classes[step] = transitions.exitRight;\n      classes[next] = transitions.enterLeft;\n    }\n\n    setClasses(classes);\n    setTimeout(() => {\n      setStep(next);\n    }, 200);\n  };\n\n  const isInvalidStep = (next: number) => {\n    return next < 0 || next >= totalSteps;\n  };\n\n  const isReactComponent = (child: React.ReactElement) => {\n    const { type } = child;\n\n    return typeof type === 'function' || typeof type === 'object';\n  };\n\n  const followingComponentsRequireValidation = () => {\n    const components = getSteps().splice(step + 1, totalSteps);\n\n    return (components as React.ReactElement[]).some(comp => {\n      if (comp.props?.validation) {\n        return true;\n      }\n      return false;\n    });\n  };\n\n  const isEmpty = (obj: { [key: string]: any }) => {\n    return Object.keys(obj).length === 0;\n  };\n\n  // remove validation from props\n  const { validation, ...childProps } = child.props;\n  const filteredChild = { ...child, props: childProps };\n\n  return (\n    <Formik {...rest} validationSchema={schema}>\n      {({ validateForm }) => (\n        <Step transitions={Boolean(animate) ? classes[childIndex] : ''}>\n          {isReactComponent(child)\n            ? React.cloneElement(filteredChild, {\n                currentStep: step + 1,\n                totalSteps,\n                nextStep: () => {\n                  validateForm().then(errors => {\n                    if (isEmpty(errors)) {\n                      setActiveStep(step + 1);\n                    }\n                  });\n                },\n                previousStep: () => setActiveStep(step - 1),\n                firstStep: () => setActiveStep(0),\n                goToStep: (next: number) => setActiveStep(next - 1),\n                lastStep: () => {\n                  if (followingComponentsRequireValidation()) {\n                    if (process.env.NODE_ENV !== 'production') {\n                      console.error('Following components require validation');\n                    }\n                  } else {\n                    validateForm().then(errors => {\n                      if (isEmpty(errors)) {\n                        setActiveStep(totalSteps - 1);\n                      }\n                    });\n                  }\n                },\n              })\n            : child}\n        </Step>\n      )}\n    </Formik>\n  );\n};\n\nexport default FormikStepper;\n\nconst Step = ({\n  children,\n  transitions,\n}: {\n  children: React.ReactNode;\n  transitions: string;\n}) => {\n  return <div className={transitions}>{children}</div>;\n};\n"],"names":["FormikStepper","props","children","animate","rest","getSteps","React","Children","toArray","totalSteps","length","useState","step","setStep","classes","setClasses","child","Array","isArray","childIndex","schema","yup","shape","validation","transitions","enterRight","enterLeft","exitRight","exitLeft","setActiveStep","next","isInvalidStep","console","error","setTimeout","isReactComponent","type","followingComponentsRequireValidation","components","splice","some","comp","isEmpty","obj","Object","keys","childProps","filteredChild","Formik","validationSchema","validateForm","Step","Boolean","cloneElement","currentStep","nextStep","then","errors","previousStep","firstStep","goToStep","lastStep","className"],"mappings":"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"}