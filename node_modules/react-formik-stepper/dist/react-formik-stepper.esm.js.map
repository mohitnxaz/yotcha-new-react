{"version":3,"file":"react-formik-stepper.esm.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Formik } from 'formik';\nimport * as yup from 'yup';\nimport 'animate.css';\nimport { FormikStepperProps } from './types/FormikStepperProps';\nimport { FormikTransitions } from './types/FormikTransitions';\n\nconst FormikStepper = (props: FormikStepperProps) => {\n  const { children, animate = true, ...rest } = props;\n\n  const getSteps = () => React.Children.toArray(children);\n\n  const totalSteps = getSteps().length;\n  const [step, setStep] = useState(0);\n  const [classes, setClasses] = useState<{\n    [key: string]: string;\n  }>({});\n\n  let child = Array.isArray(children) ? children[step] : children;\n  const childIndex = Array.isArray(children) ? step : 0;\n  const schema = yup.object().shape(child.props?.validation || {});\n\n  const transitions = {\n    enterRight: `animate__animated animate__fadeInRight`,\n    enterLeft: `animate__animated animate__fadeInLeft`,\n    exitRight: `animate__animated animate__fadeOutRight`,\n    exitLeft: `animate__animated animate__fadeOutLeft`,\n  };\n\n  const setActiveStep = (next: number) => {\n    if (next === step) return;\n\n    if (isInvalidStep(next)) {\n      if (process.env.NODE_ENV !== 'production') {\n        console.error(`${next + 1} is an invalid step`);\n      }\n      return;\n    }\n\n    const classes: FormikTransitions = {};\n\n    if (step < next) {\n      //slide left\n      classes[step] = transitions.exitLeft;\n      classes[next] = transitions.enterRight;\n    } else {\n      //slide right\n      classes[step] = transitions.exitRight;\n      classes[next] = transitions.enterLeft;\n    }\n\n    setClasses(classes);\n    setTimeout(() => {\n      setStep(next);\n    }, 200);\n  };\n\n  const isInvalidStep = (next: number) => {\n    return next < 0 || next >= totalSteps;\n  };\n\n  const isReactComponent = (child: React.ReactElement) => {\n    const { type } = child;\n\n    return typeof type === 'function' || typeof type === 'object';\n  };\n\n  const followingComponentsRequireValidation = () => {\n    const components = getSteps().splice(step + 1, totalSteps);\n\n    return (components as React.ReactElement[]).some(comp => {\n      if (comp.props?.validation) {\n        return true;\n      }\n      return false;\n    });\n  };\n\n  const isEmpty = (obj: { [key: string]: any }) => {\n    return Object.keys(obj).length === 0;\n  };\n\n  // remove validation from props\n  const { validation, ...childProps } = child.props;\n  const filteredChild = { ...child, props: childProps };\n\n  return (\n    <Formik {...rest} validationSchema={schema}>\n      {({ validateForm }) => (\n        <Step transitions={Boolean(animate) ? classes[childIndex] : ''}>\n          {isReactComponent(child)\n            ? React.cloneElement(filteredChild, {\n                currentStep: step + 1,\n                totalSteps,\n                nextStep: () => {\n                  validateForm().then(errors => {\n                    if (isEmpty(errors)) {\n                      setActiveStep(step + 1);\n                    }\n                  });\n                },\n                previousStep: () => setActiveStep(step - 1),\n                firstStep: () => setActiveStep(0),\n                goToStep: (next: number) => setActiveStep(next - 1),\n                lastStep: () => {\n                  if (followingComponentsRequireValidation()) {\n                    if (process.env.NODE_ENV !== 'production') {\n                      console.error('Following components require validation');\n                    }\n                  } else {\n                    validateForm().then(errors => {\n                      if (isEmpty(errors)) {\n                        setActiveStep(totalSteps - 1);\n                      }\n                    });\n                  }\n                },\n              })\n            : child}\n        </Step>\n      )}\n    </Formik>\n  );\n};\n\nexport default FormikStepper;\n\nconst Step = ({\n  children,\n  transitions,\n}: {\n  children: React.ReactNode;\n  transitions: string;\n}) => {\n  return <div className={transitions}>{children}</div>;\n};\n"],"names":["FormikStepper","props","children","animate","rest","getSteps","React","Children","toArray","totalSteps","length","useState","step","setStep","classes","setClasses","child","Array","isArray","childIndex","schema","yup","shape","validation","transitions","enterRight","enterLeft","exitRight","exitLeft","setActiveStep","next","isInvalidStep","process","env","NODE_ENV","console","error","setTimeout","isReactComponent","type","followingComponentsRequireValidation","components","splice","some","comp","isEmpty","obj","Object","keys","childProps","filteredChild","Formik","validationSchema","validateForm","Step","Boolean","cloneElement","currentStep","nextStep","then","errors","previousStep","firstStep","goToStep","lastStep","className"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,IAAMA,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD;;;EACpB,IAAQC,QAAR,GAA8CD,KAA9C,CAAQC,QAAR;uBAA8CD,KAA9C,CAAkBE,OAAlB;MAAkBA,OAAlB,+BAA4B,IAA5B;MAAqCC,IAArC,iCAA8CH,KAA9C;;EAEA,IAAMI,QAAQ,GAAG,SAAXA,QAAW;IAAA,OAAMC,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBN,QAAvB,CAAN;GAAjB;;EAEA,IAAMO,UAAU,GAAGJ,QAAQ,GAAGK,MAA9B;;EACA,gBAAwBC,QAAQ,CAAC,CAAD,CAAhC;MAAOC,IAAP;MAAaC,OAAb;;EACA,iBAA8BF,QAAQ,CAEnC,EAFmC,CAAtC;MAAOG,OAAP;MAAgBC,UAAhB;;EAIA,IAAIC,KAAK,GAAGC,KAAK,CAACC,OAAN,CAAchB,QAAd,IAA0BA,QAAQ,CAACU,IAAD,CAAlC,GAA2CV,QAAvD;EACA,IAAMiB,UAAU,GAAGF,KAAK,CAACC,OAAN,CAAchB,QAAd,IAA0BU,IAA1B,GAAiC,CAApD;EACA,IAAMQ,MAAM,GAAGC,MAAA,GAAaC,KAAb,CAAmB,iBAAAN,KAAK,CAACf,KAAN,kCAAasB,UAAb,KAA2B,EAA9C,CAAf;EAEA,IAAMC,WAAW,GAAG;IAClBC,UAAU,0CADQ;IAElBC,SAAS,yCAFS;IAGlBC,SAAS,2CAHS;IAIlBC,QAAQ;GAJV;;EAOA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD;IACpB,IAAIA,IAAI,KAAKlB,IAAb,EAAmB;;IAEnB,IAAImB,aAAa,CAACD,IAAD,CAAjB,EAAyB;MACvB,IAAIE,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;QACzCC,OAAO,CAACC,KAAR,CAAiBN,IAAI,GAAG,CAAxB;;;MAEF;;;IAGF,IAAMhB,OAAO,GAAsB,EAAnC;;IAEA,IAAIF,IAAI,GAAGkB,IAAX,EAAiB;;MAEfhB,OAAO,CAACF,IAAD,CAAP,GAAgBY,WAAW,CAACI,QAA5B;MACAd,OAAO,CAACgB,IAAD,CAAP,GAAgBN,WAAW,CAACC,UAA5B;KAHF,MAIO;;MAELX,OAAO,CAACF,IAAD,CAAP,GAAgBY,WAAW,CAACG,SAA5B;MACAb,OAAO,CAACgB,IAAD,CAAP,GAAgBN,WAAW,CAACE,SAA5B;;;IAGFX,UAAU,CAACD,OAAD,CAAV;IACAuB,UAAU,CAAC;MACTxB,OAAO,CAACiB,IAAD,CAAP;KADQ,EAEP,GAFO,CAAV;GAvBF;;EA4BA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACD,IAAD;IACpB,OAAOA,IAAI,GAAG,CAAP,IAAYA,IAAI,IAAIrB,UAA3B;GADF;;EAIA,IAAM6B,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACtB,KAAD;IACvB,IAAQuB,IAAR,GAAiBvB,KAAjB,CAAQuB,IAAR;IAEA,OAAO,OAAOA,IAAP,KAAgB,UAAhB,IAA8B,OAAOA,IAAP,KAAgB,QAArD;GAHF;;EAMA,IAAMC,oCAAoC,GAAG,SAAvCA,oCAAuC;IAC3C,IAAMC,UAAU,GAAGpC,QAAQ,GAAGqC,MAAX,CAAkB9B,IAAI,GAAG,CAAzB,EAA4BH,UAA5B,CAAnB;IAEA,OAAQgC,UAAmC,CAACE,IAApC,CAAyC,UAAAC,IAAI;;;MACnD,mBAAIA,IAAI,CAAC3C,KAAT,aAAI,YAAYsB,UAAhB,EAA4B;QAC1B,OAAO,IAAP;;;MAEF,OAAO,KAAP;KAJM,CAAR;GAHF;;EAWA,IAAMsB,OAAO,GAAG,SAAVA,OAAU,CAACC,GAAD;IACd,OAAOC,MAAM,CAACC,IAAP,CAAYF,GAAZ,EAAiBpC,MAAjB,KAA4B,CAAnC;GADF;;;sBAKsCM,KAAK,CAACf,KAA5C;MAAuBgD,UAAvB;;EACA,IAAMC,aAAa,gBAAQlC,KAAR;IAAef,KAAK,EAAEgD;IAAzC;;EAEA,OACE3C,mBAAA,CAAC6C,MAAD,oBAAY/C;IAAMgD,gBAAgB,EAAEhC;IAApC,EACG;IAAA,IAAGiC,YAAH,QAAGA,YAAH;IAAA,OACC/C,mBAAA,CAACgD,IAAD;MAAM9B,WAAW,EAAE+B,OAAO,CAACpD,OAAD,CAAP,GAAmBW,OAAO,CAACK,UAAD,CAA1B,GAAyC;KAA5D,EACGmB,gBAAgB,CAACtB,KAAD,CAAhB,GACGV,KAAK,CAACkD,YAAN,CAAmBN,aAAnB,EAAkC;MAChCO,WAAW,EAAE7C,IAAI,GAAG,CADY;MAEhCH,UAAU,EAAVA,UAFgC;MAGhCiD,QAAQ,EAAE;QACRL,YAAY,GAAGM,IAAf,CAAoB,UAAAC,MAAM;UACxB,IAAIf,OAAO,CAACe,MAAD,CAAX,EAAqB;YACnB/B,aAAa,CAACjB,IAAI,GAAG,CAAR,CAAb;;SAFJ;OAJ8B;MAUhCiD,YAAY,EAAE;QAAA,OAAMhC,aAAa,CAACjB,IAAI,GAAG,CAAR,CAAnB;OAVkB;MAWhCkD,SAAS,EAAE;QAAA,OAAMjC,aAAa,CAAC,CAAD,CAAnB;OAXqB;MAYhCkC,QAAQ,EAAE,kBAACjC,IAAD;QAAA,OAAkBD,aAAa,CAACC,IAAI,GAAG,CAAR,CAA/B;OAZsB;MAahCkC,QAAQ,EAAE;QACR,IAAIxB,oCAAoC,EAAxC,EAA4C;UAC1C,IAAIR,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;YACzCC,OAAO,CAACC,KAAR,CAAc,yCAAd;;SAFJ,MAIO;UACLiB,YAAY,GAAGM,IAAf,CAAoB,UAAAC,MAAM;YACxB,IAAIf,OAAO,CAACe,MAAD,CAAX,EAAqB;cACnB/B,aAAa,CAACpB,UAAU,GAAG,CAAd,CAAb;;WAFJ;;;KAnBN,CADH,GA4BGO,KA7BN,CADD;GADH,CADF;AAqCD,CApHD;;AAwHA,IAAMsC,IAAI,GAAG,SAAPA,IAAO;MACXpD,iBAAAA;MACAsB,oBAAAA;EAKA,OAAOlB,mBAAA,MAAA;IAAK2D,SAAS,EAAEzC;GAAhB,EAA8BtB,QAA9B,CAAP;AACD,CARD;;;;"}